# Data Repo (proposals)

Этот проект хранит предложения и их версии в отдельном git‑репозитории данных.
Это позволяет обновлять код и данные независимо.

## Где лежат данные

По умолчанию:
- `~/compot-data/proposals`

Фактический путь задается в `config.json`:

```json
{
  "dataRepo": {
    "path": "/Users/<user>/compot-data",
    "remote": "git@github.com:sobakapav/compot-data.git",
    "branch": "users/<login>",
    "autoPushMinutes": 60
  }
}
```

## Поведение

- Авто‑push выполняется раз в час, пока запущен сервер.
- Ручной push: кнопка «Сохранить все в облаке» на `/all`.
- При остановке через `stop.sh` выполняется принудительный `commit/push`.

## Миграция старых данных (разово)

Если в кодовом репозитории остались старые предложения (`data/proposals`),
их нужно перенести в data‑repo. Скрипт установки делает это автоматически,
если целевая папка пуста.

## Требования git

Для коммитов в data‑repo должны быть настроены:
- `git config user.name`
- `git config user.email`

## Типичные проблемы

1) Push не происходит
- Проверь `config.json` и доступ к `dataRepo.path`.
- Убедись, что `dataRepo.path` — это git‑репозиторий с `origin`.

2) Branch не найден
- Ветка создается при установке. Если нет — создай вручную и зафиксируй в `config.json`.
